function [xopt, fopt] = ganew(n, evals)  pop_size = log(n)*100;  ps_size = pop_size/4;  pc_size = 3*ps_size;    pcrossover = 0.6;  pm1 = 1/n;    evals_count = 1;  s = 1;  k = 1;    fp = rand(1,n) > 0.5;  xopt = fp;  fopt = labs(xopt);    for i = 2:pop_size    pop_{i} = (rand(1,n) > 0.5);    pop_fit_{i} = labs(pop_{i});   end      c = min(cell2mat(pop_fit_));      while evals_count <= evals     working_while_1 = true;   while working_while_1   for j=1:length(pop_fit_())       psel = (pop_fit_{j}-c)/(sum(cell2mat(pop_fit_())) - pop_size*c);       x=rand;        if x<psel          selected_parent{k}=pop_{j};          k++;          if k >= (ps_size)             working_while_1 = false;            break;            end        end     end    end         working_while_2 = true;    while working_while_2          for j=1:length(selected_parent)              x=rand;        if x<pcrossover          crossover_pair{s}=selected_parent{j};          if mod(s,2)==0            point = randi([1,n]);            pair_1 = crossover_pair{s-1};            pair_2 = crossover_pair{s};                        offspring{s-1} = [pair_1(1:point),pair_2(point+1:end)];            offspring{s} = [pair_2(1:point),pair_1(point+1:end)];            end            s++;                      if s >= (pc_size)             working_while_2 = false;            break;            end        end     end         end      for j = 1:length(offspring)        bits = (rand(1,n) <= pm1);      offspring{j} = mod(offspring{j}+bits,2);   end    for j = 1:length(offspring)      offspring_fit{j} = labs(offspring{j});            if offspring_fit{j} > fopt      xopt = offspring{j};      fopt = offspring_fit{j};      end            hist(evals_count:evals_count) = fopt;      evals_count++;            if evals_count >= evals        break;        end   end    if max(cell2mat(offspring_fit)) >= fopt    pop_ = offspring;    pop_fit_ = offspring_fit;  end        end  disp('GA:')  disp(fopt)  subplot(2, 1, 1)			  for i = 1:evals      plot(hist(1:i))      drawnow();  end          mc(fp,20,500);      end